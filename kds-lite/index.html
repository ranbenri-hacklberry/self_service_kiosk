<!DOCTYPE html>
<html lang="he" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>KDS Lite | iCaffe</title>
    <meta name="theme-color" content="#000000">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- Splash Screen -->
    <div id="splashScreen" class="splash-screen">
        <div class="splash-content">
            <img src="logo.png" alt="iCaffeOS" class="splash-logo">
            <div class="splash-title">iCaffeOS</div>
            <div class="splash-subtitle">kds_lite</div>
            <div class="splash-loader"></div>
        </div>
    </div>

    <!-- Header -->
    <div class="header">
        <div class="header-right">
            <div class="station-name" id="stationName">🌐 כל התחנות</div>
            <div class="order-count" id="orderCount">0</div>
        </div>

        <div class="header-center" id="superAdminContainer" style="display: none;">
            <select id="superBusinessSelect" class="business-switcher" onchange="switchBusiness(this.value)">
                <option value="">🔄 בחר עסק...</option>
            </select>
        </div>

        <div class="header-left">
            <div class="status" id="status">מתחבר...</div>
            <div class="header-actions">
                <button class="settings-btn" onclick="openSettings()">⚙️</button>
                <button class="logout-btn" onclick="handleLogout()">🚪 יציאה</button>
            </div>
        </div>
    </div>

    <!-- Orders Container -->
    <div class="orders-container">
        <div class="orders-scroll" id="ordersContainer">
            <div class="empty-state">
                <div>טוען הזמנות...</div>
                <div style="font-size: 14px;">מחפש בכל התחנות</div>
            </div>
        </div>
    </div>

    <!-- Items Summary Section -->
    <div class="summary-container">
        <div class="summary-title">📊 סיכום מנות - כל ההזמנות הפעילות</div>
        <div class="summary-grid" id="summaryGrid">
            <div style="grid-column: 1/-1; text-align: center; color: #00AA00; padding: 20px;">
                טוען סיכום...
            </div>
        </div>
    </div>

    <!-- Login Screen -->
    <div id="loginScreen" class="login-screen">
        <div class="login-card">
            <img src="logo.png" alt="Logo" class="login-logo">
            <h1 class="login-title">כניסת עובד</h1>

            <div class="auth-tabs">
                <button id="tabPin" class="auth-tab active" onclick="switchAuthTab('pin')">📌 קוד PIN</button>
                <button id="tabPass" class="auth-tab" onclick="switchAuthTab('pass')">🔐 סיסמה</button>
            </div>

            <!-- PIN Login View -->
            <div id="pinView" class="auth-view active">
                <p class="login-subtitle">הכנס PIN כדי להתחיל</p>
                <div class="login-form">
                    <div class="pin-display">
                        <div id="pinDots" class="pin-dots">
                            <span></span><span></span><span></span><span></span>
                        </div>
                    </div>
                    <div class="numpad">
                        <button onclick="appendPin('1')">1</button>
                        <button onclick="appendPin('2')">2</button>
                        <button onclick="appendPin('3')">3</button>
                        <button onclick="appendPin('4')">4</button>
                        <button onclick="appendPin('5')">5</button>
                        <button onclick="appendPin('6')">6</button>
                        <button onclick="appendPin('7')">7</button>
                        <button onclick="appendPin('8')">8</button>
                        <button onclick="appendPin('9')">9</button>
                        <button onclick="clearPin()" class="btn-clear">C</button>
                        <button onclick="appendPin('0')">0</button>
                        <button id="loginSubmitBtn" onclick="submitLogin('pin')" class="btn-submit">➜</button>
                    </div>
                </div>
            </div>

            <!-- Password Login View -->
            <div id="passView" class="auth-view">
                <p class="login-subtitle">הכנס טלפון/מייל וסיסמה</p>
                <div class="login-form-fields">
                    <div class="form-group">
                        <input type="text" id="loginIdentifier" placeholder="טלפון או אימייל" class="auth-input">
                    </div>
                    <div class="form-group">
                        <input type="password" id="loginPassword" placeholder="סיסמה" class="auth-input">
                    </div>
                    <button onclick="submitLogin('pass')" class="btn-full-width">כניסה</button>
                </div>
            </div>

            <div id="loginError" class="login-error"></div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <h2 class="modal-title">⚙️ הגדרות KDS</h2>

            <div class="form-group">
                <label>עסק:</label>
                <select id="businessSelect">
                    <option value="11111111-1111-1111-1111-111111111111">עסק 1</option>
                    <option value="22222222-2222-2222-2222-222222222222">עסק 2</option>
                </select>
            </div>

            <div class="form-group">
                <label>תחנה:</label>
                <select id="stationSelect">
                    <option value="ALL" selected>🌐 כל התחנות (ALL)</option>
                    <option value="Bar">🍸 בר (Bar)</option>
                    <option value="Kitchen">🍳 מטבח (Kitchen)</option>
                    <option value="Desserts">🍰 קינוחים (Desserts)</option>
                    <option value="Pass">📋 פאס (Pass)</option>
                </select>
            </div>

            <div class="form-group">
                <label>מצב תצוגה:</label>
                <select id="debugModeSelect">
                    <option value="in_progress" selected>רק בהכנה (in_progress)</option>
                    <option value="all">כל הסטטוסים (Debug)</option>
                </select>
            </div>

            <div class="modal-buttons">
                <button class="btn btn-save" onclick="saveSettings()">💾 שמור</button>
                <button class="btn btn-cancel" onclick="closeSettings()">✖️ ביטול</button>
            </div>
        </div>
    </div>

    <!-- Keyboard Navigation Hint -->
    <div style="position: fixed; bottom: 10px; left: 10px; 
                background: rgba(0, 0, 0, 0.8); 
                color: #00D4FF; 
                padding: 8px 15px; 
                border-radius: 8px; 
                font-size: 13px;
                border: 2px solid #00D4FF;
                box-shadow: 0 0 15px rgba(0, 212, 255, 0.5);
                z-index: 1000;
                font-weight: bold;">
        ◀️ ▶️ חיצים לניווט
    </div>

    <!-- SDKs -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="app.js"></script>
</body>

</html>